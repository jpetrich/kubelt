<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" content="text/html" http-equiv="Content-Type" />
		<meta content="" name="description" />
		<title>Kubelt SDK Reference</title>
 		<link rel="stylesheet" type="text/css" href="css/shCore.css" />
		<style type="text/css">.syntaxhighlighter{overflow:hidden !important;}</style>
		<link rel="stylesheet" type="text/css" href="css/shThemeMarginalia.css" />
		<link rel="stylesheet" type="text/css" href="css/marginalia.css" />
		<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
		<script type="text/javascript" src="js/xregexp-min.js"></script>
		<script type="text/javascript" src="js/shCore.js"></script>
		<script type="text/javascript" src="js/shBrushClojure.js"></script>
	</head>
	<body>
		<table>
			<tr>
				<td class="docs">
					<div class="docs-header">
						<a class="anchor" href="#repl" name="repl">
							<h1 class="project-name">octet.cljc</h1>
							<a class="toc-link" href="index.html">toc</a>
						</a>
					</div>
				</td>
				<td class="codes" />
			</tr>
			<tr>
				<td class="docs">
					<p>Byte-related utilities.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(ns com.kubelt.lib.octet
  {:copyright &quot;Â©2022 Proof Zero Inc.&quot; :license &quot;Apache 2.0&quot;}
  #?(:clj
     (:import
      [java.nio.charset StandardCharsets]))
  #?(:cljs
     (:require
      [&quot;@stablelib/utf8&quot; :as utf8])))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Convert the input into a platform-specific byte sequence. In Clojure, a byte array is returned. In ClojureScript, a Uint8Array is returned.</p><p>Note that Node.js Buffer objects are a subclass of the JavaScript Uint8Array class that extends it with additional methods. Node.js APIs accept plain Uint8Arrays wherever Buffers are supported as well, so we prefer to work just with Uint8Array, if possible. Also note that JavaScript strings are encoded as UTF-16 by default, whereas in node they're UTF-8 encoded, so we need to perform some conversion first.</p><p>TODO rename to str->utf8-bytes?</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- str-&gt;bytes
  [x]
  {:pre [(string? x)]}
  #?(:clj (if-not (bytes? x)
            (let [charset (StandardCharsets/UTF_8)]
              (.getBytes x charset))
            x)
     :cljs (.encode utf8 x)))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Using Buffer.from() works! Using Uint8Array.from() does <em>not</em> work!</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">#_(let [encoder (js/TextEncoder.)]
    (.encode encoder x))
#_(js/Uint8Array.from x)
#_(js/Buffer.from x)
;; Public
;; -----------------------------------------------------------------------------
;; TODO test me
(defn as-bytes
  [x]
  (cond
    (string? x) (str-&gt;bytes x)
    ;; TODO if given bytes, return bytes. Need x-platform (bytes?).
    :else x))</pre>
				</td>
			</tr>
			<tr>
				<td class="spacer docs">&nbsp;</td>
				<td class="codes" />
			</tr>
		</table>
		<div class="footer">Generated by <a href="https://github.com/captain-porcelain/sidenotes">Sidenotes</a>.&nbsp;&nbsp;Syntax highlighting provided by Alex Gorbatchev's <a href="http://alexgorbatchev.com/SyntaxHighlighter/">SyntaxHighlighter</a>
		</div>
		<script type="text/javascript" src="js/app.js"></script>
	</body>
</html>
