<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" content="text/html" http-equiv="Content-Type" />
		<meta content="" name="description" />
		<title>Kubelt SDK Reference</title>
 		<link rel="stylesheet" type="text/css" href="css/shCore.css" />
		<style type="text/css">.syntaxhighlighter{overflow:hidden !important;}</style>
		<link rel="stylesheet" type="text/css" href="css/shThemeMarginalia.css" />
		<link rel="stylesheet" type="text/css" href="css/marginalia.css" />
		<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
		<script type="text/javascript" src="js/xregexp-min.js"></script>
		<script type="text/javascript" src="js/shCore.js"></script>
		<script type="text/javascript" src="js/shBrushClojure.js"></script>
	</head>
	<body>
		<table>
			<tr>
				<td class="docs">
					<div class="docs-header">
						<a class="anchor" href="#repl" name="repl">
							<h1 class="project-name">com.kubelt.ddt.prompt</h1>
							<a class="toc-link" href="index.html">toc</a>
						</a>
					</div>
				</td>
				<td class="codes" />
			</tr>
			<tr>
				<td class="docs">
					<p>Configuration for prompt.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(ns com.kubelt.ddt.prompt
  {:copyright &quot;Â©2022 Proof Zero Inc.&quot; :license &quot;Apache 2.0&quot;}
  (:require
   [&quot;prompt&quot; :as prompt])
  (:require
   [clojure.string :as cstr]))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- pw-clean
  [s]
  ;; TODO should we do this?
  ;; Trim whitespace from before/after input.
  (cstr/trim s))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def pw-regex
  #&quot;^\\w+\$&quot;)</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def mnemonic-config
  {:mnemonic
   {:description &quot;Enter your mnemonic phrase&quot;
    :type &quot;string&quot;
    :message &quot;Password must be 12 words&quot;
    :hidden true
    :replace &quot;*&quot;
    :required true
    :before pw-clean}})</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def password-config
  {:password
   {:description &quot;Enter your password&quot;
    :type &quot;string&quot;
    ;; TODO constrain the password
    ;;:pattern pw-regex
    ;; TODO update regex failure error message
    :message &quot;Password must be letters&quot;
    :hidden true
    :replace &quot;*&quot;
    :required true
    ;; Run before callbacks, can modify user's input.
    :before pw-clean}})</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def confirm-config
  {:confirm
   {:description &quot;Confirm your password&quot;
    :type &quot;string&quot;
    ;; TODO constrain the password
    ;;:pattern pw-regex
    ;; TODO update regex failure error message
    :message &quot;Password must be letters&quot;
    :hidden true
    :replace &quot;*&quot;
    :required true
    :before pw-clean}})</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>The prompt schema determines what is asked for from the user. NB: "before" fn is run before callbacks and can modify user's input.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def ask-pw-schema
  (clj-&gt;js
   {:properties password-config}))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def ask-mnemonic-schema
  (clj-&gt;js
   {:properties mnemonic-config}))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def confirm-schema
  (clj-&gt;js
   {:properties (merge password-config
                       confirm-config)}))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def truthy-map
  {&quot;y&quot; true
   &quot;yes&quot; true
   &quot;true&quot; true
   &quot;t&quot; true
   &quot;n&quot; false
   &quot;no&quot; false
   &quot;false&quot; false
   &quot;f&quot; false})</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def truthy-set
  (into #{} (keys truthy-map)))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def rm-schema
  (clj-&gt;js
   {:properties
    {:confirm
     {:description &quot;Are you sure [yes/no]?&quot;
      :type &quot;string&quot;
      :required true
      :before (fn [x]
                (-&gt; x cstr/trim cstr/lower-case))
      :conform (fn [x]
                 (contains? truthy-set x))}}}))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<h2>Public</h2>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Prompt the user for their password. Expects a callback function that accepts an error and a result parameter: (fn [err result] ...).</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn ask!
  [callback ask-schema]
  {:pre [(fn? callback)]}
  ;; Remove the preliminary prompt set by default in &quot;prompt&quot; library.
  (set! (.-message prompt) &quot;&quot;)
  ;; Prompt the user for their wallet password.
  (.start prompt)
  (.get prompt ask-schema callback))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Prompt the user for their password. Expects a callback function that accepts an error and a result parameter: (fn [err result] ...).</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn ask-mnemonic!
  [callback]
  {:pre [(fn? callback)]}
  (ask! callback ask-mnemonic-schema))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Prompt the user for their password. Expects a callback function that accepts an error and a result parameter: (fn [err result] ...).</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn ask-password!
  [callback]
  {:pre [(fn? callback)]}
  (ask! callback ask-pw-schema))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Prompt the user for their password twice and passes along an error message message if they're not identical. Expects a callback function that accepts an error and a result parameter: (fn [err result] ...).</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn confirm-password!
  [callback]
  {:pre [(fn? callback)]}
  ;; Remove the preliminary prompt set by default in &quot;prompt&quot; library.
  (set! (.-message prompt) &quot;&quot;)
  ;; Prompt the user for their wallet password.
  (.start prompt)
  (.get prompt confirm-schema
        (fn [err result]
          (let [password (.-password result)
                confirm (.-confirm result)]
            (when-not (= password confirm)
              (callback &quot;passwords do not match&quot; #js {})))
          (callback err result))))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Prompt the user to confirm that they want to delete a wallet.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn confirm-rm!
  [callback]
  {:pre [(fn? callback)]}
  ;; Remove the preliminary prompt set by default in &quot;prompt&quot; library.
  (set! (.-message prompt) &quot;&quot;)
  ;; Display the prompt.
  (.start prompt)
  (.get prompt rm-schema (fn [err result]
                           (let [confirm-str (.-confirm result)
                                 rm? (get truthy-map confirm-str false)]
                             (callback err rm?)))))</pre>
				</td>
			</tr>
			<tr>
				<td class="spacer docs">&nbsp;</td>
				<td class="codes" />
			</tr>
		</table>
		<div class="footer">Generated by <a href="https://github.com/captain-porcelain/sidenotes">Sidenotes</a>.&nbsp;&nbsp;Syntax highlighting provided by Alex Gorbatchev's <a href="http://alexgorbatchev.com/SyntaxHighlighter/">SyntaxHighlighter</a>
		</div>
		<script type="text/javascript" src="js/app.js"></script>
	</body>
</html>
