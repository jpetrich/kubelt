<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" content="text/html" http-equiv="Content-Type" />
		<meta content="" name="description" />
		<title>Kubelt SDK Reference</title>
 		<link rel="stylesheet" type="text/css" href="css/shCore.css" />
		<style type="text/css">.syntaxhighlighter{overflow:hidden !important;}</style>
		<link rel="stylesheet" type="text/css" href="css/shThemeMarginalia.css" />
		<link rel="stylesheet" type="text/css" href="css/marginalia.css" />
		<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
		<script type="text/javascript" src="js/xregexp-min.js"></script>
		<script type="text/javascript" src="js/shCore.js"></script>
		<script type="text/javascript" src="js/shBrushClojure.js"></script>
	</head>
	<body>
		<table>
			<tr>
				<td class="docs">
					<div class="docs-header">
						<a class="anchor" href="#repl" name="repl">
							<h1 class="project-name">com.kubelt.lib.jwk</h1>
							<a class="toc-link" href="index.html">toc</a>
						</a>
					</div>
				</td>
				<td class="codes" />
			</tr>
			<tr>
				<td class="docs">
					<p>JSON Web Key implementation</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(ns com.kubelt.lib.jwk
  {:copyright &quot;Â©2022 Proof Zero Inc.&quot; :license &quot;Apache 2.0&quot;})</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>TODO NB! this is just an experiment that might be thrown out. Don't rely on this for anything unless this warning is removed.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<h2>Public</h2>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>TODO move these to com.kubelt.lib.jwk</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Return an object in JWK Set Format. This is a JSON object representing a set of JWKs.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- jwk-set
  []
  {:keys []})</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Add a JSON Web Key to a JWK Set of keys.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- jwk-add
  [key-set key]
  (update key-set :keys conj key))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- jwk-make-key
  [id]
  {:com.kubelt/type :kubelt.type/jwk
   :jwk/id id})</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Sets the Key Type parameter. This value <em>must</em> be present in a JWK and must be registered in the IANA JSON Web Key types registry or be a value that contains a Collision-Resistant name.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- jwk-set-type
  [jwk key-type]
  (assoc jwk :jwk/type key-type))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- jwk-set-alg
  [jwk key-alg]
  (assoc jwk :jwk/algorithm key-alg))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def key-use
  #{:enc
    :sig})</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Sets the public key use parameter that conveys the intended use of the public key, i.e. for encrypting data of verifying the signature on data. The specification allows for the values 'sig' (signature) and 'enc' (encryption), although other values may be used.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- jwk-set-use
  [jwk key-use]
  (assoc jwk :jwk/use key-use))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(def key-ops
  #{;; compute digital signature or MAC
    :sign
    ;; verify digital signature or MAC
    :verify
    ;; encrypt content
    :encrypt
    ;; decrypt content and validate decryption, if applicable
    :decrypt
    ;; encrypt key
    :wrap-key
    ;; decrypt key and validate decryption, if applicable
    :unwrap-key
    ;; derive key
    :derive-key
    ;; derive bits not to be used as a key
    :derive-bits})</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Add a single key operation as a keyword to the collection of existing operations, or co</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- jwk-add-ops
  [jwk key-ops]
  (let [ops (get jwk :key/operations #{})
        ops (cond
              ;; given a single keyword as operation
              (keyword? key-ops)
              (conj ops key-ops)
              ;; given a vector of keywords as operation
              (and (vector? key-ops)
                   (every? keyword? key-ops))
              (cset/union ops (into #{} key-ops)))]
    (assoc jwk :jwk/operations ops)))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- jwk-as-obj
  [jwk]
  (letfn [(kw-&gt;str [kw]
            (name (csk/-&gt;camelCase kw)))]
    (let [key-id (get jwk :jwk/id)
          key-type (get jwk :jwk/type)
          key-use (kw-&gt;str (get jwk :jwk/use))
          key-alg (kw-&gt;str (get jwk :jwk/algorithm))
          key-ops (mapv kw-&gt;str (get jwk :jwk/operations))]
      (clj-&gt;js
       {:kid key-id
        :kty key-type
        :use key-use
        :alg key-alg
        :key_ops key-ops}))))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn- jwk-from-eth
  [eth-wallet]
  (let [jwk-pub {:fixme :public}
        jwk-sec {:fixme :secret}]
    [jwk-pub jwk-sec]))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Example JWK: Elliptic Curve DSS key used with P-256 elliptic curve, with x and y coordinates are the base64url-encoded values shown. A key identifier is also provided for the key.</p><p>{"kty":"EC",  "crv":"P-256",  "x":"f83OJ3D2xF1Bg8vub9tLe1gHMzV76e8Tus9uPHvRVEU",  "y":"x<i>FEzRu9m36HLN</i>tue659LNpXW6pCyStikYjKIWI5a0",  "kid":"Public key used in JWS spec Appendix A.3 example"}</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Example public keys:</p><p>{"keys":   [     {"kty":"EC",      "crv":"P-256",      "x":"MKBCTNIcKUSDii11ySs3526iDZ8AiTo7Tu6KPAqv7D4",      "y":"4Etl6SRW2YiLUrN5vfvVHuhp7x8PxltmWWlbbM4IFyM",      "use":"enc",      "kid":"1"},</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<pre><code>{&quot;kty&quot;:&quot;RSA&quot;,
 &quot;n&quot;: &quot;0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx</code></pre>4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMstn64tZ<i>2W-5JsGY4Hc5n9yBXArwl93lqt7</i>RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbISD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqbw0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",<pre><code> &quot;e&quot;:&quot;AQAB&quot;,
 &quot;alg&quot;:&quot;RS256&quot;,
 &quot;kid&quot;:&quot;2011-04-29&quot;}</code></pre>  ]}
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Example private keys: {"keys":    [      {"kty":"EC",       "crv":"P-256",       "x":"MKBCTNIcKUSDii11ySs3526iDZ8AiTo7Tu6KPAqv7D4",       "y":"4Etl6SRW2YiLUrN5vfvVHuhp7x8PxltmWWlbbM4IFyM",       "d":"870MB6gfuTJ4HtUnUvYMyJpr5eUZNP4Bk43bVdj3eAE",       "use":"enc",       "kid":"1"},</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<pre><code> {&quot;kty&quot;:&quot;RSA&quot;,
  &quot;n&quot;:&quot;0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx4</code></pre> cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMst n64tZ<i>2W-5JsGY4Hc5n9yBXArwl93lqt7</i>RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2Q vzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbIS D08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqbw 0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",<pre><code>  &quot;e&quot;:&quot;AQAB&quot;,
  &quot;d&quot;:&quot;X4cTteJY&#95;gn4FYPsXB8rdXix5vwsg1FLN5E3EaG6RJoVH-HLLKD9</code></pre> M7dx5oo7GURknchnrRweUkC7hT5fJLM0WbFAKNLWY2vv7B6NqXSzUvxT0_YSfqij wp3RTzlBaCxWp4doFk5N2o8Gy_nHNKroADIkJ46pRUohsXywbReAdYaMwFs9tv8d _cPVY3i07a3t8MN6TNwm0dSawm9v47UiCl3Sk5ZiG7xojPLu4sbg1U2jx4IBTNBz nbJSzFHK66jT8bgkuqsk0GjskDJk19Z4qwjwbsnn4j2WBii3RL-Us2lGVkY8fkFz me1z0HbIkfz0Y6mqnOYtqc0X4jfcKoAC8Q",<pre><code>  &quot;p&quot;:&quot;83i-7IvMGXoMXCskv73TKr8637FiO7Z27zv8oj6pbWUQyLPQBQxtPV</code></pre> nwD20R-60eTDmD2ujnMt5PoqMrm8RfmNhVWDtjjMmCMjOpSXicFHj7XOuVIYQyqV WlWEh6dN36GVZYk93N8Bc9vY41xy8B9RzzOGVQzXvNEvn7O0nVbfs",<pre><code>  &quot;q&quot;:&quot;3dfOR9cuYq-0S-mkFLzgItgMEfFzB2q3hWehMuG0oCuqnb3vobLyum</code></pre> qjVZQO1dIrdwgTnCdpYzBcOfW5r370AFXjiWft_NGEiovonizhKpo9VVS78TzFgx kIdrecRezsZ-1kYd_s1qDbxtkDEgfAITAG9LUnADun4vIcb6yelxk",<pre><code>  &quot;dp&quot;:&quot;G4sPXkc6Ya9y8oJW9&#95;ILj4xuppu0lzi&#95;H7VTkS8xj5SdX3coE0oim</code></pre> YwxIi2emTAue0UOa5dpgFGyBJ4c8tQ2VF402XRugKDTP8akYhFo5tAA77Qe_Nmtu YZc3C3m3I24G2GvR5sSDxUyAN2zq8Lfn9EUms6rY3Ob8YeiKkTiBj0",<pre><code>  &quot;dq&quot;:&quot;s9lAH9fggBsoFR8Oac2R&#95;E2gw282rT2kGOAhvIllETE1efrA6huUU</code></pre> vMfBcMpn8lqeW6vzznYY5SSQF7pMdC<i>agI3nG8Ibp1BUb0JUiraRNqUfLhcQb</i>d9 GF4Dh7e74WbRsobRonujTYN1xCaP6TO61jvWrX-L18txXw494Q_cgk",<pre><code>  &quot;qi&quot;:&quot;GyM&#95;p6JrXySiz1toFgKbWV-JdI3jQ4ypu9rbMWx3rQJBfmt0FoYzg</code></pre> UIZEVFEcOqwemRN81zoDAaa-Bk0KWNGDjJHZDdDmFhW3AN7lI-puxk_mHZGJ11rx yR8O55XLSe3SPmRfKwZI6yU24ZxvQKFYItdldUKGzO6Ia6zTKhAVRU",<pre><code>  &quot;alg&quot;:&quot;RS256&quot;,
  &quot;kid&quot;:&quot;2011-04-29&quot;}</code></pre>   ] }
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Example symmetric keys:</p><p>{"keys": [      {"kty":"oct",       "alg":"A128KW",       "k":"GawgguFyGrWKav7AX4VKUg"},</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<pre><code> {&quot;kty&quot;:&quot;oct&quot;,
  &quot;k&quot;:&quot;AyM1SysPpbyDfgZld3umj1qzKObwVMkoqQ-EstJQLr&#95;T-1qS0gZH75</code></pre> aKtMN3Yj0iPS4hcgUuTwjAzZr1Z9CAow",<pre><code>  &quot;kid&quot;:&quot;HMAC key used in JWS spec Appendix A.1 example&quot;}</code></pre>   ] }
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="spacer docs">&nbsp;</td>
				<td class="codes" />
			</tr>
		</table>
		<div class="footer">Generated by <a href="https://github.com/captain-porcelain/sidenotes">Sidenotes</a>.&nbsp;&nbsp;Syntax highlighting provided by Alex Gorbatchev's <a href="http://alexgorbatchev.com/SyntaxHighlighter/">SyntaxHighlighter</a>
		</div>
		<script type="text/javascript" src="js/app.js"></script>
	</body>
</html>
