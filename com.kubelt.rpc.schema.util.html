<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" content="text/html" http-equiv="Content-Type" />
		<meta content="" name="description" />
		<title>Kubelt SDK Reference</title>
 		<link rel="stylesheet" type="text/css" href="css/shCore.css" />
		<style type="text/css">.syntaxhighlighter{overflow:hidden !important;}</style>
		<link rel="stylesheet" type="text/css" href="css/shThemeMarginalia.css" />
		<link rel="stylesheet" type="text/css" href="css/marginalia.css" />
		<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
		<script type="text/javascript" src="js/xregexp-min.js"></script>
		<script type="text/javascript" src="js/shCore.js"></script>
		<script type="text/javascript" src="js/shBrushClojure.js"></script>
	</head>
	<body>
		<table>
			<tr>
				<td class="docs">
					<div class="docs-header">
						<a class="anchor" href="#repl" name="repl">
							<h1 class="project-name">com.kubelt.rpc.schema.util</h1>
							<a class="toc-link" href="index.html">toc</a>
						</a>
					</div>
				</td>
				<td class="codes" />
			</tr>
			<tr>
				<td class="docs">
					<p>OpenRPC schema utilities.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(ns com.kubelt.rpc.schema.util
  {:copyright &quot;Â©2022 Proof Zero Inc.&quot; :license &quot;Apache 2.0&quot;}
  (:require
   [clojure.string :as cstr])
  (:require
   [camel-snake-kebab.core :as csk]))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<h2>s->kw</h2>
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Convert a string to a keyword, transforming it into idiomatic kebab case.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn s-&gt;kw
  [s]
  (-&gt; s keyword csk/-&gt;kebab-case))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<h2>name->path</h2>TODO allow to override the separator; should be passed as aconfiguration value in the (init) options map.TODO make private
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Given a string resource name, return a 'path' data value (a vector of keywords). Currently assumes that names use '_' as a separator between path components.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn name-&gt;path
  [s]
  {:pre [(string? s)]}
  (let [parts (cstr/split s #&quot;_&quot;)]
    (mapv s-&gt;kw parts)))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<h2>ref->path</h2>For example:{:\$ref "#/components/contentDescriptors/Transaction"}=> [:components :content-descriptors :transaction]
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Given a reference map (containing a :\$ref key), return a path of keywords that may be used with (get-in) to get the referenced value in a schema.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn ref-&gt;path
  [s]
  (as-&gt; s \$
    (cstr/split \$ #&quot;/&quot;)
    (drop 1 \$)
    (mapv s-&gt;kw \$)))</pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<h2>lookup</h2>TODO memoize
				</td>
				<td class="codes">
					<pre class="brush: clojure"></pre>
				</td>
			</tr>
			<tr>
				<td class="docs">
					<p>Given a schema and a reference map (containing a :\$ref key), return the value being referred to by the reference string. References can refer to other references so it's necessary to recursively look them up.</p>
				</td>
				<td class="codes">
					<pre class="brush: clojure">(defn lookup
  [\$ref schema]
  {:pre [(string? \$ref) (map? schema)]}
  (loop [components (get schema :components)
         ref-path (ref-&gt;path \$ref)
         ref-val (get-in schema ref-path)]
    ;;(prn ref-path)
    ;;(prn ref-val)
    (if-not (contains? ref-val :\$ref)
      ref-val
      (recur components ref-path ref-val))))</pre>
				</td>
			</tr>
			<tr>
				<td class="spacer docs">&nbsp;</td>
				<td class="codes" />
			</tr>
		</table>
		<div class="footer">Generated by <a href="https://github.com/captain-porcelain/sidenotes">Sidenotes</a>.&nbsp;&nbsp;Syntax highlighting provided by Alex Gorbatchev's <a href="http://alexgorbatchev.com/SyntaxHighlighter/">SyntaxHighlighter</a>
		</div>
		<script type="text/javascript" src="js/app.js"></script>
	</body>
</html>
